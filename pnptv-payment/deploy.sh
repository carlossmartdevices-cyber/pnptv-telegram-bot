#!/bin/bash

# PNPtv Payment System - Vercel Deployment Script
# This script automates the deployment process

set -e

echo "=========================================="
echo "PNPtv Payment System - Vercel Deployment"
echo "=========================================="
echo ""

# Check if Vercel CLI is installed
if ! command -v vercel &> /dev/null; then
    echo "âŒ Vercel CLI not found. Installing..."
    npm i -g vercel
fi

echo "âœ“ Vercel CLI ready"
echo ""

# Navigate to project
cd /root/Bots/pnptv-payment

echo "ğŸ“¦ Building project..."
npm run build
echo "âœ“ Build successful"
echo ""

echo "âš ï¸  You will now need to:"
echo ""
echo "1ï¸âƒ£  DEPLOYMENT OPTIONS:"
echo "   Option A: Using Vercel GitHub Integration (Recommended)"
echo "   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   â€¢ Push code to GitHub: git push origin main"
echo "   â€¢ Go to https://vercel.com/dashboard"
echo "   â€¢ Click 'Add New' â†’ 'Project'"
echo "   â€¢ Import your pnptv-payment repository"
echo "   â€¢ Skip environment variables (do next)"
echo ""
echo "   Option B: Using Vercel CLI (Quick)"
echo "   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   â€¢ Run: vercel"
echo "   â€¢ Follow prompts to link your account"
echo "   â€¢ Skip setting env vars"
echo ""
echo "2ï¸âƒ£  ENVIRONMENT VARIABLES:"
echo "   After deployment, add these to Vercel project:"
echo ""
echo "   REQUIRED (Production Use):"
echo "   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   â€¢ NEXT_PUBLIC_RECIPIENT_ADDRESS = your_daimo_wallet"
echo "   â€¢ FIREBASE_PROJECT_ID = your_firebase_id"
echo "   â€¢ FIREBASE_CLIENT_EMAIL = your_firebase_email"
echo "   â€¢ FIREBASE_PRIVATE_KEY = your_firebase_key"
echo "   â€¢ FIREBASE_DATABASE_URL = your_firebase_url"
echo "   â€¢ WEBHOOK_SECRET = $(openssl rand -hex 32)"
echo "   â€¢ NODE_ENV = production"
echo ""
echo "   OPTIONAL (Monitoring):"
echo "   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   â€¢ NEXT_PUBLIC_SENTRY_DSN = your_sentry_dsn"
echo "   â€¢ SENTRY_AUTH_TOKEN = your_sentry_token"
echo ""
echo "3ï¸âƒ£  HOW TO ADD ENV VARS TO VERCEL:"
echo "   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   Method A: Dashboard"
echo "   1. Go to https://vercel.com/dashboard"
echo "   2. Select your pnptv-payment project"
echo "   3. Settings â†’ Environment Variables"
echo "   4. Add each variable (set to Production)"
echo "   5. Redeploy: Deployments â†’ Redeploy"
echo ""
echo "   Method B: CLI"
echo "   1. vercel env add NEXT_PUBLIC_RECIPIENT_ADDRESS"
echo "   2. vercel env add FIREBASE_PROJECT_ID"
echo "   3. (repeat for all vars)"
echo "   4. vercel --prod"
echo ""
echo "4ï¸âƒ£  SENTRY SETUP (Optional but Recommended):"
echo "   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   1. Create account: https://sentry.io"
echo "   2. Create project â†’ Next.js"
echo "   3. Get DSN from project settings"
echo "   4. Add NEXT_PUBLIC_SENTRY_DSN to Vercel"
echo ""
echo "5ï¸âƒ£  VERIFY DEPLOYMENT:"
echo "   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   âœ“ App loads at: https://your-project.vercel.app"
echo "   âœ“ UI displays correctly"
echo "   âœ“ No console errors"
echo "   âœ“ Webhook endpoint accessible"
echo "   âœ“ Firebase connected (logs processed)"
echo ""
echo "=========================================="
echo "ğŸ“š For detailed instructions, see:"
echo "   â€¢ DEPLOYMENT_GUIDE.md"
echo "   â€¢ MONITORING_SETUP.md"
echo "   â€¢ README.md"
echo "=========================================="
echo ""
echo "Ready to deploy? Run:"
echo "   vercel"