import{r as Ae,g as Ie}from"./index-By-z2tYg.js";import{r as Be}from"./index-BV8s6ez1.js";function ke(e,l){for(var s=0;s<l.length;s++){const g=l[s];if(typeof g!="string"&&!Array.isArray(g)){for(const a in g)if(a!=="default"&&!(a in e)){const t=Object.getOwnPropertyDescriptor(g,a);t&&Object.defineProperty(e,a,t.get?t:{enumerable:!0,get:()=>g[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var J={exports:{}},re;function He(){if(re)return J.exports;re=1;var e=typeof Reflect=="object"?Reflect:null,l=e&&typeof e.apply=="function"?e.apply:function(r,o,d){return Function.prototype.apply.call(r,o,d)},s;e&&typeof e.ownKeys=="function"?s=e.ownKeys:Object.getOwnPropertySymbols?s=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:s=function(r){return Object.getOwnPropertyNames(r)};function g(n){console&&console.warn&&console.warn(n)}var a=Number.isNaN||function(r){return r!==r};function t(){t.init.call(this)}J.exports=t,J.exports.once=T,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._eventsCount=0,t.prototype._maxListeners=void 0;var c=10;function i(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(t,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(n){if(typeof n!="number"||n<0||a(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");c=n}}),t.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},t.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||a(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function f(n){return n._maxListeners===void 0?t.defaultMaxListeners:n._maxListeners}t.prototype.getMaxListeners=function(){return f(this)},t.prototype.emit=function(r){for(var o=[],d=1;d<arguments.length;d++)o.push(arguments[d]);var _=r==="error",w=this._events;if(w!==void 0)_=_&&w.error===void 0;else if(!_)return!1;if(_){var m;if(o.length>0&&(m=o[0]),m instanceof Error)throw m;var E=new Error("Unhandled error."+(m?" ("+m.message+")":""));throw E.context=m,E}var H=w[r];if(H===void 0)return!1;if(typeof H=="function")l(H,this,o);else for(var se=H.length,qe=S(H,se),d=0;d<se;++d)l(qe[d],this,o);return!0};function h(n,r,o,d){var _,w,m;if(i(o),w=n._events,w===void 0?(w=n._events=Object.create(null),n._eventsCount=0):(w.newListener!==void 0&&(n.emit("newListener",r,o.listener?o.listener:o),w=n._events),m=w[r]),m===void 0)m=w[r]=o,++n._eventsCount;else if(typeof m=="function"?m=w[r]=d?[o,m]:[m,o]:d?m.unshift(o):m.push(o),_=f(n),_>0&&m.length>_&&!m.warned){m.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+m.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");E.name="MaxListenersExceededWarning",E.emitter=n,E.type=r,E.count=m.length,g(E)}return n}t.prototype.addListener=function(r,o){return h(this,r,o,!1)},t.prototype.on=t.prototype.addListener,t.prototype.prependListener=function(r,o){return h(this,r,o,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(n,r,o){var d={fired:!1,wrapFn:void 0,target:n,type:r,listener:o},_=u.bind(d);return _.listener=o,d.wrapFn=_,_}t.prototype.once=function(r,o){return i(o),this.on(r,v(this,r,o)),this},t.prototype.prependOnceListener=function(r,o){return i(o),this.prependListener(r,v(this,r,o)),this},t.prototype.removeListener=function(r,o){var d,_,w,m,E;if(i(o),_=this._events,_===void 0)return this;if(d=_[r],d===void 0)return this;if(d===o||d.listener===o)--this._eventsCount===0?this._events=Object.create(null):(delete _[r],_.removeListener&&this.emit("removeListener",r,d.listener||o));else if(typeof d!="function"){for(w=-1,m=d.length-1;m>=0;m--)if(d[m]===o||d[m].listener===o){E=d[m].listener,w=m;break}if(w<0)return this;w===0?d.shift():P(d,w),d.length===1&&(_[r]=d[0]),_.removeListener!==void 0&&this.emit("removeListener",r,E||o)}return this},t.prototype.off=t.prototype.removeListener,t.prototype.removeAllListeners=function(r){var o,d,_;if(d=this._events,d===void 0)return this;if(d.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):d[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete d[r]),this;if(arguments.length===0){var w=Object.keys(d),m;for(_=0;_<w.length;++_)m=w[_],m!=="removeListener"&&this.removeAllListeners(m);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(o=d[r],typeof o=="function")this.removeListener(r,o);else if(o!==void 0)for(_=o.length-1;_>=0;_--)this.removeListener(r,o[_]);return this};function p(n,r,o){var d=n._events;if(d===void 0)return[];var _=d[r];return _===void 0?[]:typeof _=="function"?o?[_.listener||_]:[_]:o?b(_):S(_,_.length)}t.prototype.listeners=function(r){return p(this,r,!0)},t.prototype.rawListeners=function(r){return p(this,r,!1)},t.listenerCount=function(n,r){return typeof n.listenerCount=="function"?n.listenerCount(r):y.call(n,r)},t.prototype.listenerCount=y;function y(n){var r=this._events;if(r!==void 0){var o=r[n];if(typeof o=="function")return 1;if(o!==void 0)return o.length}return 0}t.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]};function S(n,r){for(var o=new Array(r),d=0;d<r;++d)o[d]=n[d];return o}function P(n,r){for(;r+1<n.length;r++)n[r]=n[r+1];n.pop()}function b(n){for(var r=new Array(n.length),o=0;o<r.length;++o)r[o]=n[o].listener||n[o];return r}function T(n,r){return new Promise(function(o,d){function _(m){n.removeListener(r,w),d(m)}function w(){typeof n.removeListener=="function"&&n.removeListener("error",_),o([].slice.call(arguments))}L(n,r,w,{once:!0}),r!=="error"&&C(n,_,{once:!0})})}function C(n,r,o){typeof n.on=="function"&&L(n,"error",r,o)}function L(n,r,o,d){if(typeof n.on=="function")d.once?n.once(r,o):n.on(r,o);else if(typeof n.addEventListener=="function")n.addEventListener(r,function _(w){d.once&&n.removeEventListener(r,_),o(w)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}return J.exports}var X={},D={},O={},k={},j={},N={},V={},ne;function Oe(){if(ne)return V;ne=1,Object.defineProperty(V,"__esModule",{value:!0}),V.getSDKVersion=void 0;const e=()=>"9.1.0";return V.getSDKVersion=e,V}var U={},ie;function De(){if(ie)return U;ie=1,Object.defineProperty(U,"__esModule",{value:!0}),U.generateRequestId=void 0;const e=g=>g.toString(16).padStart(2,"0"),l=g=>{const a=new Uint8Array(g/2);return window.crypto.getRandomValues(a),Array.from(a,e).join("")},s=()=>typeof window<"u"?l(10):new Date().getTime().toString(36);return U.generateRequestId=s,U}var ae;function Re(){if(ae)return N;ae=1,Object.defineProperty(N,"__esModule",{value:!0}),N.MessageFormatter=void 0;const e=Oe(),l=De();class s{}return N.MessageFormatter=s,s.makeRequest=(g,a)=>({id:(0,l.generateRequestId)(),method:g,params:a,env:{sdkVersion:(0,e.getSDKVersion)()}}),s.makeResponse=(g,a,t)=>({id:g,success:!0,version:t,data:a}),s.makeErrorResponse=(g,a,t)=>({id:g,success:!1,error:a,version:t}),N}var M={},oe;function B(){if(oe)return M;oe=1,Object.defineProperty(M,"__esModule",{value:!0}),M.RestrictedMethods=M.Methods=void 0;var e;(function(s){s.sendTransactions="sendTransactions",s.rpcCall="rpcCall",s.getChainInfo="getChainInfo",s.getSafeInfo="getSafeInfo",s.getTxBySafeTxHash="getTxBySafeTxHash",s.getSafeBalances="getSafeBalances",s.signMessage="signMessage",s.signTypedMessage="signTypedMessage",s.getEnvironmentInfo="getEnvironmentInfo",s.getOffChainSignature="getOffChainSignature",s.requestAddressBook="requestAddressBook",s.wallet_getPermissions="wallet_getPermissions",s.wallet_requestPermissions="wallet_requestPermissions"})(e||(M.Methods=e={}));var l;return(function(s){s.requestAddressBook="requestAddressBook"})(l||(M.RestrictedMethods=l={})),M}var ue;function Ne(){return ue||(ue=1,(function(e){var l=j&&j.__createBinding||(Object.create?(function(t,c,i,f){f===void 0&&(f=i);var h=Object.getOwnPropertyDescriptor(c,i);(!h||("get"in h?!c.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return c[i]}}),Object.defineProperty(t,f,h)}):(function(t,c,i,f){f===void 0&&(f=i),t[f]=c[i]})),s=j&&j.__exportStar||function(t,c){for(var i in t)i!=="default"&&!Object.prototype.hasOwnProperty.call(c,i)&&l(c,t,i)};Object.defineProperty(e,"__esModule",{value:!0});const g=Re();class a{constructor(c=null,i=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:f,data:h,source:u})=>{const v=!h,p=!this.isServer&&u===window.parent,y=typeof h.version<"u"&&parseInt(h.version.split(".")[0]),S=typeof y=="number"&&y>=1;let P=!0;return Array.isArray(this.allowedOrigins)&&(P=this.allowedOrigins.find(b=>b.test(f))!==void 0),!v&&p&&S&&P},this.logIncomingMessage=f=>{console.info(`Safe Apps SDK v1: A message was received from origin ${f.origin}. `,f.data)},this.onParentMessage=f=>{this.isValidMessage(f)&&(this.debugMode&&this.logIncomingMessage(f),this.handleIncomingMessage(f.data))},this.handleIncomingMessage=f=>{const{id:h}=f,u=this.callbacks.get(h);u&&(u(f),this.callbacks.delete(h))},this.send=(f,h)=>{const u=g.MessageFormatter.makeRequest(f,h);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(u,"*"),new Promise((v,p)=>{this.callbacks.set(u.id,y=>{if(!y.success){p(new Error(y.error));return}v(y)})})},this.allowedOrigins=c,this.debugMode=i,this.isServer||window.addEventListener("message",this.onParentMessage)}}e.default=a,s(B(),e)})(j)),j}var F={},x={},G={},ce;function Ve(){if(ce)return G;ce=1,Object.defineProperty(G,"__esModule",{value:!0}),G.isObjectEIP712TypedData=void 0;const e=l=>typeof l=="object"&&l!=null&&"domain"in l&&"types"in l&&"message"in l;return G.isObjectEIP712TypedData=e,G}var Y={},de;function Ue(){return de||(de=1,Object.defineProperty(Y,"__esModule",{value:!0})),Y}var z={},le;function Fe(){return le||(le=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TransferDirection=e.TransactionStatus=e.TokenType=e.Operation=void 0;var l=Be();Object.defineProperty(e,"Operation",{enumerable:!0,get:function(){return l.Operation}}),Object.defineProperty(e,"TokenType",{enumerable:!0,get:function(){return l.TokenType}}),Object.defineProperty(e,"TransactionStatus",{enumerable:!0,get:function(){return l.TransactionStatus}}),Object.defineProperty(e,"TransferDirection",{enumerable:!0,get:function(){return l.TransferDirection}})})(z)),z}var Z={},fe;function Ge(){return fe||(fe=1,Object.defineProperty(Z,"__esModule",{value:!0}),B()),Z}var he;function ee(){return he||(he=1,(function(e){var l=x&&x.__createBinding||(Object.create?(function(g,a,t,c){c===void 0&&(c=t);var i=Object.getOwnPropertyDescriptor(a,t);(!i||("get"in i?!a.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return a[t]}}),Object.defineProperty(g,c,i)}):(function(g,a,t,c){c===void 0&&(c=t),g[c]=a[t]})),s=x&&x.__exportStar||function(g,a){for(var t in g)t!=="default"&&!Object.prototype.hasOwnProperty.call(a,t)&&l(a,g,t)};Object.defineProperty(e,"__esModule",{value:!0}),s(Ve(),e),s(Ue(),e),s(Fe(),e),s(Ge(),e)})(x)),x}var ge;function We(){if(ge)return F;ge=1,Object.defineProperty(F,"__esModule",{value:!0}),F.TXs=void 0;const e=B(),l=ee();class s{constructor(a){this.communicator=a}async getBySafeTxHash(a){if(!a)throw new Error("Invalid safeTxHash");return(await this.communicator.send(e.Methods.getTxBySafeTxHash,{safeTxHash:a})).data}async signMessage(a){const t={message:a};return(await this.communicator.send(e.Methods.signMessage,t)).data}async signTypedMessage(a){if(!(0,l.isObjectEIP712TypedData)(a))throw new Error("Invalid typed data");return(await this.communicator.send(e.Methods.signTypedMessage,{typedData:a})).data}async send({txs:a,params:t}){if(!a||!a.length)throw new Error("No transactions were passed");const c={txs:a,params:t};return(await this.communicator.send(e.Methods.sendTransactions,c)).data}}return F.TXs=s,F}var W={},$={},_e;function te(){return _e||(_e=1,Object.defineProperty($,"__esModule",{value:!0}),$.RPC_CALLS=void 0,$.RPC_CALLS={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"}),$}var pe;function $e(){if(pe)return W;pe=1,Object.defineProperty(W,"__esModule",{value:!0}),W.Eth=void 0;const e=te(),l=B(),s={defaultBlockParam:(a="latest")=>a,returnFullTxObjectParam:(a=!1)=>a,blockNumberToHex:a=>Number.isInteger(a)?`0x${a.toString(16)}`:a};class g{constructor(t){this.communicator=t,this.call=this.buildRequest({call:e.RPC_CALLS.eth_call,formatters:[null,s.defaultBlockParam]}),this.getBalance=this.buildRequest({call:e.RPC_CALLS.eth_getBalance,formatters:[null,s.defaultBlockParam]}),this.getCode=this.buildRequest({call:e.RPC_CALLS.eth_getCode,formatters:[null,s.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:e.RPC_CALLS.eth_getStorageAt,formatters:[null,s.blockNumberToHex,s.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:e.RPC_CALLS.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:e.RPC_CALLS.eth_getBlockByHash,formatters:[null,s.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:e.RPC_CALLS.eth_getBlockByNumber,formatters:[s.blockNumberToHex,s.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:e.RPC_CALLS.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:e.RPC_CALLS.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:e.RPC_CALLS.eth_getTransactionCount,formatters:[null,s.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:e.RPC_CALLS.eth_gasPrice}),this.getEstimateGas=c=>this.buildRequest({call:e.RPC_CALLS.eth_estimateGas})([c]),this.setSafeSettings=this.buildRequest({call:e.RPC_CALLS.safe_setSettings})}buildRequest(t){const{call:c,formatters:i}=t;return async f=>{i&&Array.isArray(f)&&i.forEach((v,p)=>{v&&(f[p]=v(f[p]))});const h={call:c,params:f||[]};return(await this.communicator.send(l.Methods.rpcCall,h)).data}}}return W.Eth=g,W}var R={},q={},me;function Ke(){if(me)return q;me=1,Object.defineProperty(q,"__esModule",{value:!0}),q.MAGIC_VALUE_BYTES=q.MAGIC_VALUE=void 0;const e="0x1626ba7e";q.MAGIC_VALUE=e;const l="0x20c13b0b";return q.MAGIC_VALUE_BYTES=l,q}var Q={},K={},A={},ve;function je(){if(ve)return A;ve=1,Object.defineProperty(A,"__esModule",{value:!0}),A.PermissionsError=A.PERMISSIONS_REQUEST_REJECTED=void 0,A.PERMISSIONS_REQUEST_REJECTED=4001;class e extends Error{constructor(s,g,a){super(s),this.code=g,this.data=a,Object.setPrototypeOf(this,e.prototype)}}return A.PermissionsError=e,A}var ye;function Me(){if(ye)return K;ye=1,Object.defineProperty(K,"__esModule",{value:!0}),K.Wallet=void 0;const e=B(),l=je();class s{constructor(a){this.communicator=a}async getPermissions(){return(await this.communicator.send(e.Methods.wallet_getPermissions,void 0)).data}async requestPermissions(a){if(!this.isPermissionRequestValid(a))throw new l.PermissionsError("Permissions request is invalid",l.PERMISSIONS_REQUEST_REJECTED);try{return(await this.communicator.send(e.Methods.wallet_requestPermissions,a)).data}catch{throw new l.PermissionsError("Permissions rejected",l.PERMISSIONS_REQUEST_REJECTED)}}isPermissionRequestValid(a){return a.every(t=>typeof t=="object"?Object.keys(t).every(c=>!!Object.values(e.RestrictedMethods).includes(c)):!1)}}return K.Wallet=s,K}var be;function Je(){if(be)return Q;be=1,Object.defineProperty(Q,"__esModule",{value:!0});const e=Me(),l=je(),s=(a,t)=>t.some(c=>c.parentCapability===a),g=()=>(a,t,c)=>{const i=c.value;return c.value=async function(){const f=new e.Wallet(this.communicator);let h=await f.getPermissions();if(s(t,h)||(h=await f.requestPermissions([{[t]:{}}])),!s(t,h))throw new l.PermissionsError("Permissions rejected",l.PERMISSIONS_REQUEST_REJECTED);return i.apply(this)},c};return Q.default=g,Q}var we;function Qe(){if(we)return R;we=1;var e=R&&R.__decorate||function(h,u,v,p){var y=arguments.length,S=y<3?u:p===null?p=Object.getOwnPropertyDescriptor(u,v):p,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(h,u,v,p);else for(var b=h.length-1;b>=0;b--)(P=h[b])&&(S=(y<3?P(S):y>3?P(u,v,S):P(u,v))||S);return y>3&&S&&Object.defineProperty(u,v,S),S},l=R&&R.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(R,"__esModule",{value:!0}),R.Safe=void 0;const s=Ae(),g=Ke(),a=B(),t=te(),c=ee(),i=l(Je());class f{constructor(u){this.communicator=u}async getChainInfo(){return(await this.communicator.send(a.Methods.getChainInfo,void 0)).data}async getInfo(){return(await this.communicator.send(a.Methods.getSafeInfo,void 0)).data}async experimental_getBalances({currency:u="usd"}={}){return(await this.communicator.send(a.Methods.getSafeBalances,{currency:u})).data}async check1271Signature(u,v="0x"){const p=await this.getInfo(),y=(0,s.encodeFunctionData)({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[u,v]}),S={call:t.RPC_CALLS.eth_call,params:[{to:p.safeAddress,data:y},"latest"]};try{return(await this.communicator.send(a.Methods.rpcCall,S)).data.slice(0,10).toLowerCase()===g.MAGIC_VALUE}catch{return!1}}async check1271SignatureBytes(u,v="0x"){const p=await this.getInfo(),y=(0,s.encodeFunctionData)({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[u,v]}),S={call:t.RPC_CALLS.eth_call,params:[{to:p.safeAddress,data:y},"latest"]};try{return(await this.communicator.send(a.Methods.rpcCall,S)).data.slice(0,10).toLowerCase()===g.MAGIC_VALUE_BYTES}catch{return!1}}calculateMessageHash(u){return(0,s.hashMessage)(u)}calculateTypedMessageHash(u){const v=typeof u.domain.chainId=="object"?u.domain.chainId.toNumber():Number(u.domain.chainId);let p=u.primaryType;if(!p){const y=Object.values(u.types),S=Object.keys(u.types).filter(P=>y.every(b=>b.every(({type:T})=>T.replace("[","").replace("]","")!==P)));if(S.length===0||S.length>1)throw new Error("Please specify primaryType");p=S[0]}return(0,s.hashTypedData)({message:u.message,domain:{...u.domain,chainId:v,verifyingContract:u.domain.verifyingContract,salt:u.domain.salt},types:u.types,primaryType:p})}async getOffChainSignature(u){return(await this.communicator.send(a.Methods.getOffChainSignature,u)).data}async isMessageSigned(u,v="0x"){let p;if(typeof u=="string"&&(p=async()=>{const y=this.calculateMessageHash(u);return await this.isMessageHashSigned(y,v)}),(0,c.isObjectEIP712TypedData)(u)&&(p=async()=>{const y=this.calculateTypedMessageHash(u);return await this.isMessageHashSigned(y,v)}),p)return await p();throw new Error("Invalid message type")}async isMessageHashSigned(u,v="0x"){const p=[this.check1271Signature.bind(this),this.check1271SignatureBytes.bind(this)];for(const y of p)if(await y(u,v))return!0;return!1}async getEnvironmentInfo(){return(await this.communicator.send(a.Methods.getEnvironmentInfo,void 0)).data}async requestAddressBook(){return(await this.communicator.send(a.Methods.requestAddressBook,void 0)).data}}return R.Safe=f,e([(0,i.default)()],f.prototype,"requestAddressBook",null),R}var Se;function Pe(){if(Se)return k;Se=1;var e=k&&k.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(k,"__esModule",{value:!0});const l=e(Ne()),s=We(),g=$e(),a=Qe(),t=Me();class c{constructor(f={}){const{allowedDomains:h=null,debug:u=!1}=f;this.communicator=new l.default(h,u),this.eth=new g.Eth(this.communicator),this.txs=new s.TXs(this.communicator),this.safe=new a.Safe(this.communicator),this.wallet=new t.Wallet(this.communicator)}}return k.default=c,k}var Te;function Xe(){return Te||(Te=1,(function(e){var l=O&&O.__createBinding||(Object.create?(function(c,i,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(i,f);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[f]}}),Object.defineProperty(c,h,u)}):(function(c,i,f,h){h===void 0&&(h=f),c[h]=i[f]})),s=O&&O.__exportStar||function(c,i){for(var f in c)f!=="default"&&!Object.prototype.hasOwnProperty.call(i,f)&&l(i,c,f)},g=O&&O.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(e,"__esModule",{value:!0}),e.getSDKVersion=void 0;const a=g(Pe());e.default=a.default,s(Pe(),e),s(ee(),e),s(B(),e),s(Re(),e);var t=Oe();Object.defineProperty(e,"getSDKVersion",{enumerable:!0,get:function(){return t.getSDKVersion}}),s(te(),e)})(O)),O}var I={},Ce;function Ye(){if(Ce)return I;Ce=1,Object.defineProperty(I,"__esModule",{value:!0}),I.numberToHex=I.getLowerCase=void 0;function e(s){return s&&s.toLowerCase()}I.getLowerCase=e;function l(s){return`0x${s.toString(16)}`}return I.numberToHex=l,I}var Le;function ze(){if(Le)return D;Le=1,Object.defineProperty(D,"__esModule",{value:!0}),D.SafeAppProvider=void 0;const e=Xe(),l=He(),s=Ye();class g extends l.EventEmitter{constructor(t,c){super(),this.submittedTxs=new Map,this.safe=t,this.sdk=c}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(t){var f,h,u,v;const{method:c,params:i=[]}=t;switch(c){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return(0,s.numberToHex)(this.chainId);case"personal_sign":{const[b,T]=i;if(this.safe.safeAddress.toLowerCase()!==T.toLowerCase())throw new Error("The address or message hash is invalid");const C=await this.sdk.txs.signMessage(b);return("signature"in C?C.signature:void 0)||"0x"}case"eth_sign":{const[b,T]=i;if(this.safe.safeAddress.toLowerCase()!==b.toLowerCase()||!T.startsWith("0x"))throw new Error("The address or message hash is invalid");const C=await this.sdk.txs.signMessage(T);return("signature"in C?C.signature:void 0)||"0x"}case"eth_signTypedData":case"eth_signTypedData_v4":{const[b,T]=i,C=typeof T=="string"?JSON.parse(T):T;if(this.safe.safeAddress.toLowerCase()!==b.toLowerCase())throw new Error("The address is invalid");const L=await this.sdk.txs.signTypedMessage(C);return("signature"in L?L.signature:void 0)||"0x"}case"eth_sendTransaction":const p={...i[0],value:i[0].value||"0",data:i[0].data||"0x"};typeof p.gas=="string"&&p.gas.startsWith("0x")&&(p.gas=parseInt(p.gas,16));const y=await this.sdk.txs.send({txs:[p],params:{safeTxGas:p.gas}});return this.submittedTxs.set(y.safeTxHash,{from:this.safe.safeAddress,hash:y.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:p.data,value:p.value,to:p.to,blockHash:null,blockNumber:null,transactionIndex:null}),y.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,s.getLowerCase)(i[0]),i[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,s.getLowerCase)(i[0]),i[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,s.getLowerCase)(i[0]),i[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,s.getLowerCase)(i[0]),i[1],i[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([i[0],i[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([i[0],i[1]]);case"eth_getTransactionByHash":let P=i[0];try{P=(await this.sdk.txs.getBySafeTxHash(P)).txHash||P}catch{}return this.submittedTxs.has(P)?this.submittedTxs.get(P):this.sdk.eth.getTransactionByHash([P]).then(b=>(b&&(b.hash=i[0]),b));case"eth_getTransactionReceipt":{let b=i[0];try{b=(await this.sdk.txs.getBySafeTxHash(b)).txHash||b}catch{}return this.sdk.eth.getTransactionReceipt([b]).then(T=>(T&&(T.transactionHash=i[0]),T))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(i[0]);case"eth_call":return this.sdk.eth.call([i[0],i[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([i[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();case"wallet_getPermissions":return this.sdk.wallet.getPermissions();case"wallet_requestPermissions":return this.sdk.wallet.requestPermissions(i[0]);case"safe_setSettings":return this.sdk.eth.setSafeSettings([i[0]]);case"wallet_sendCalls":{const{from:b,calls:T,chainId:C}=i[0];if(C!==(0,s.numberToHex)(this.chainId))throw new Error(`Safe is not on chain ${C}`);if(b!==this.safe.safeAddress)throw Error("Invalid from address");const L=T.map((o,d)=>{if(!o.to)throw new Error(`Invalid call #${d}: missing "to" field`);return{to:o.to,data:o.data??"0x",value:o.value??(0,s.numberToHex)(0)}}),{safeTxHash:n}=await this.sdk.txs.send({txs:L});return{id:n}}case"wallet_getCallsStatus":{const b=i[0],T={[e.TransactionStatus.AWAITING_CONFIRMATIONS]:100,[e.TransactionStatus.AWAITING_EXECUTION]:100,[e.TransactionStatus.SUCCESS]:200,[e.TransactionStatus.CANCELLED]:400,[e.TransactionStatus.FAILED]:500},C=await this.sdk.txs.getBySafeTxHash(b),L={version:"1.0",id:b,chainId:(0,s.numberToHex)(this.chainId),status:T[C.txStatus]};if(!C.txHash)return L;const n=await this.sdk.eth.getTransactionReceipt([C.txHash]);if(!n)return L;const r=((h=(f=C.txData)==null?void 0:f.dataDecoded)==null?void 0:h.method)!=="multiSend"?1:((v=(u=C.txData.dataDecoded.parameters)==null?void 0:u[0].valueDecoded)==null?void 0:v.length)??1,o=Number(n.blockNumber),d=Number(n.gasUsed);return L.receipts=Array(r).fill({logs:n.logs,status:(0,s.numberToHex)(C.txStatus===e.TransactionStatus.SUCCESS?1:0),blockHash:n.blockHash,blockNumber:(0,s.numberToHex)(o),gasUsed:(0,s.numberToHex)(d),transactionHash:C.txHash}),L}case"wallet_showCallsStatus":throw new Error(`"${t.method}" not supported`);case"wallet_getCapabilities":return{[(0,s.numberToHex)(this.chainId)]:{atomicBatch:{supported:!0}}};default:throw Error(`"${t.method}" not implemented`)}}send(t,c){t||c("Undefined request"),this.request(t).then(i=>c(null,{jsonrpc:"2.0",id:t.id,result:i})).catch(i=>c(i,null))}}return D.SafeAppProvider=g,D}var Ee;function Ze(){return Ee||(Ee=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeAppProvider=void 0;var l=ze();Object.defineProperty(e,"SafeAppProvider",{enumerable:!0,get:function(){return l.SafeAppProvider}})})(X)),X}var xe=Ze();const et=Ie(xe),rt=ke({__proto__:null,default:et},[xe]);export{rt as i};
